# Showrooms预订系统 - 完整测试指南

## 环境启动

### 1. 启动开发服务器
```bash
cd d:\Demand-os-v4\web
npm run dev
```
服务器将在以下地址启动：
- **本地**: http://localhost:3000
- **网络**: http://0.0.0.0:3000

### 2. 访问Showrooms页面
打开浏览器，访问：
```
http://localhost:3000/showrooms
```

---

## 完整流程测试

### 步骤 1: 页面加载验证
**预期结果：**
- ✅ 页面正确加载
- ✅ 左侧显示3D展厅模型（如果加载失败会显示备用UI）
- ✅ 右侧显示底部预订面板
- ✅ 底部有完整的楼层指南

**检查项：**
- [ ] 页面没有崩溃
- [ ] 3D组件正确渲染或显示降级UI
- [ ] 所有UI元素正确显示
- [ ] 控制台无严重错误

---

### 步骤 2: 选择楼层
**操作：**
1. 查看左侧3D展厅的楼层
2. 点击左下方的"1F"按钮（或其他楼层）

**预期结果：**
- ✅ 所选楼层被高亮显示
- ✅ 右侧面板更新显示该楼层的信息
- ✅ 楼层名称和描述正确显示

**检查项：**
- [ ] 楼层按钮响应点击
- [ ] 楼层切换平滑
- [ ] 右侧面板内容正确更新
- [ ] 3D模型中的楼层也被高亮

---

### 步骤 3: 选择区域
**操作：**
1. 在右侧面板中浏览不同的展示区域
2. 寻找带有"可预订"（绿色标签）的区域
3. 点击一个可预订的区域

**预期结果：**
- ✅ 区域被选中并高亮
- ✅ 区域的详细信息显示在面板中，包括：
  - 区域名称
  - 区域面积
  - 日均价格
  - 当前状态（绿色"可预订"）
- ✅ 底部"Reserve Zone"按钮变为可点击状态

**检查项：**
- [ ] 区域可以成功选择
- [ ] 所有区域信息正确显示
- [ ] 日均价格正确显示
- [ ] "Reserve Zone"按钮已启用

---

### 步骤 4: 选择日期范围
**操作：**
1. 在右侧面板找到日期选择器
2. 点击"From"日期输入框
3. 从日历中选择开始日期（例如：2026-02-15）
4. 点击"To"日期输入框
5. 选择结束日期（例如：2026-02-20）

**预期结果：**
- ✅ 日期选择器正确打开
- ✅ 选定的日期显示在输入框中
- ✅ 天数自动计算（例如：6天）
- ✅ 总价格自动更新：`日均价格 × 天数`

**价格计算示例：**
- 日均价格：¥5000
- 预订天数：5天
- 基础总价：¥25,000

**检查项：**
- [ ] 日期选择器可以打开
- [ ] 日期选择正确
- [ ] 天数计算正确
- [ ] 价格自动更新
- [ ] 日期范围有效（结束日期 > 开始日期）

---

### 步骤 5: 点击预留按钮
**操作：**
1. 确认已选择：楼层、区域、日期
2. 点击底部的"Reserve Zone"按钮

**预期结果：**
- ✅ 预订表单对话框打开
- ✅ 对话框显示已选区域的信息（只读）：
  - 楼层信息
  - 区域名称和面积
  - 选定的日期范围
  - 总价格
- ✅ 表单处于可编辑状态

**检查项：**
- [ ] 对话框正确打开
- [ ] 所有预填信息正确显示
- [ ] 表单字段为空且可编辑

---

### 步骤 6: 填写预订表单

#### 基本信息部分
**操作：**
填写以下字段：

| 字段 | 示例值 | 备注 |
|------|-------|------|
| 姓名 | 张三 | 至少2个字符 |
| 公司 | ABC公司 | 至少2个字符 |
| 职位 | 销售经理 | 可选 |
| 邮箱 | admin@example.com | 必须是有效的邮箱格式 |
| 电话 | 13800138000 | 必须是11位数字 |
| 微信 | wechat_id | 可选 |

**预期结果：**
- ✅ 所有必填字段接受输入
- ✅ 输入值正确显示
- ✅ 字段实时验证（如邮箱格式）

---

#### 展会信息部分
**操作：**
1. 在"展会类型"下拉菜单中选择：
   - "产品展示" (Product Exhibition)
   - "品牌发布" (Brand Launch)
   - "商务洽谈" (Business Meeting)

2. 输入"参展人数"（1-1000）：例如 50

3. 在"特殊需求"文本框输入：例如 "需要特殊展示平台"

**预期结果：**
- ✅ 展会类型下拉菜单正确打开和选择
- ✅ 参展人数接受有效输入
- ✅ 特殊需求文本框可编辑

---

#### 增值服务部分（可选）
**操作：**
根据需要选择以下服务（打勾）：

| 服务 | 价格 | 说明 |
|------|------|------|
| 装修服务 | ¥5,000 | 提供展台装修设计和施工 |
| 物流支持 | ¥3,000 | 展品运输和布置 |
| 翻译服务 | ¥2,000 | 展会期间翻译支持 |

**示例选择：**
- [ ] 装修服务 ✓
- [ ] 物流支持 ✓
- [ ] 翻译服务 ✗

**预期结果：**
- ✅ 复选框可以勾选/取消
- ✅ 每个服务的价格清晰显示
- ✅ 总价格实时更新

---

### 步骤 7: 验证价格计算

**场景 1：基础预订**
```
场次总价：¥25,000（5天 × ¥5,000/天）
增值服务：¥0
---
合计：¥25,000
```

**场景 2：包含增值服务**
```
场次总价：¥25,000
+ 装修服务：¥5,000
+ 物流支持：¥3,000
+ 翻译服务：¥2,000
---
合计：¥35,000
```

**操作：**
1. 选择不同的服务组合
2. 观察"合计"金额变化

**预期结果：**
- ✅ 价格计算正确
- ✅ 增值服务费用立即反映在总价中
- ✅ 取消服务后价格正确减少

**检查项：**
- [ ] 基础价格正确
- [ ] 增值服务费用正确添加
- [ ] 总价计算准确

---

### 步骤 8: 提交预订

**操作：**
1. 确认所有必填字段已填写
2. 点击表单底部的"提交预订"按钮

**预期结果：**
- ✅ 表单验证通过
- ✅ 出现提交成功的提示
- ✅ 预订号生成并显示（格式：BK-YYYYMMDD-XXXX）
- ✅ 确认页面显示完整的预订信息

---

### 步骤 9: 验证预订确认页面

**预期显示内容：**

| 信息类型 | 内容 |
|---------|------|
| 预订号 | BK-20260208-1234 |
| 预订状态 | 待确认 |
| 联系方式 | 张三 / admin@example.com / 13800138000 |
| 展会详情 | 产品展示 / 50人 |
| 区域信息 | 1F-A区 / 120㎡ |
| 预订期间 | 2026-02-15 至 2026-02-20 |
| 总费用 | ¥35,000 |

**检查项：**
- [ ] 预订号正确生成
- [ ] 所有输入的信息正确显示
- [ ] 价格计算准确
- [ ] 确认按钮可用

---

## 验证测试（重要）

### 测试 1: 空表单提交
**操作：**
1. 打开预订对话框
2. 不填写任何内容
3. 直接点击"提交预订"

**预期结果：**
- ✅ 出现多个验证错误提示，例如：
  - "姓名至少2个字符"
  - "公司名称至少2个字符"
  - "请输入有效的邮箱地址"
  - "请输入有效的手机号码"
- ✅ 表单不提交
- ✅ 焦点移动到第一个错误字段

**检查项：**
- [ ] 所有必填字段都有验证错误
- [ ] 错误信息清晰明了
- [ ] 用户无法提交无效表单

---

### 测试 2: 无效邮箱
**操作：**
1. 打开预订表单
2. 在邮箱字段输入：`invalid-email`
3. 点击"提交预订"

**预期结果：**
- ✅ 邮箱字段下显示错误：`"请输入有效的邮箱地址"`
- ✅ 表单不提交
- ✅ 其他有效输入可以继续填写

**测试用例：**
| 输入 | 结果 |
|------|------|
| `test` | ❌ 错误 |
| `test@` | ❌ 错误 |
| `test@domain` | ❌ 错误 |
| `test@domain.com` | ✅ 正确 |
| `user+tag@example.co.uk` | ✅ 正确 |

**检查项：**
- [ ] 简单无效格式被拒绝
- [ ] 标准邮箱格式被接受
- [ ] 复杂有效格式被接受

---

### 测试 3: 无效手机号
**操作：**
1. 打开预订表单
2. 在电话字段输入：`12345`
3. 点击"提交预订"

**预期结果：**
- ✅ 电话字段下显示错误：`"请输入有效的手机号码"`
- ✅ 表单不提交

**测试用例：**
| 输入 | 长度 | 结果 |
|------|------|------|
| `123` | 3位 | ❌ 错误 |
| `12345678901` | 11位 | ✅ 正确 |
| `1380013800` | 10位 | ❌ 错误 |
| `138001380000` | 12位 | ⚠️ 取决于规则 |

**检查项：**
- [ ] 短号码被拒绝
- [ ] 11位号码被接受
- [ ] 长号码的处理合理

---

### 测试 4: 超长输入
**操作：**
1. 在"特殊需求"字段输入非常长的文本（超过500字符）
2. 尝试提交

**预期结果：**
- ✅ 输入被接受或显示长度限制提示
- ✅ 表单行为合理

---

### 测试 5: 特殊字符和中文
**操作：**
1. 在"姓名"字段输入：`李明-Zhang`
2. 在"公司"字段输入：`北京ABC科技有限公司`
3. 在"特殊需求"字段输入：`需要特殊照明设备 & 展示柜`

**预期结果：**
- ✅ 中文和特殊字符被正确处理
- ✅ 表单可以成功提交
- ✅ 确认页面正确显示所有字符

**检查项：**
- [ ] 中文输入支持
- [ ] 特殊字符（如 &、-、/）支持
- [ ] 数据库正确存储和显示

---

### 测试 6: 日期验证
**操作：**
1. 尝试选择结束日期早于开始日期
2. 尝试选择过去的日期
3. 尝试选择相同的开始和结束日期

**预期结果：**
- ✅ 不允许结束日期早于开始日期
- ✅ 允许选择将来的日期
- ✅ 允许选择相同的日期（1天预订）

**检查项：**
- [ ] 日期逻辑验证正确
- [ ] 错误提示清晰
- [ ] 边界情况处理合理

---

### 测试 7: 参展人数验证
**操作：**
1. 尝试输入：`0` → 应显示错误
2. 尝试输入：`50` → 应接受
3. 尝试输入：`1001` → 应显示错误
4. 尝试输入：`abc` → 应显示错误或清除

**预期结果：**
- ✅ 0被拒绝
- ✅ 1-1000被接受
- ✅ 超过1000被拒绝
- ✅ 非数字被拒绝

**检查项：**
- [ ] 最小值验证（1）
- [ ] 最大值验证（1000）
- [ ] 类型验证（数字）

---

### 测试 8: 浏览器兼容性
**操作：**
在不同浏览器中测试：
1. Chrome/Edge (Chromium)
2. Firefox
3. Safari (如果有Mac)

**预期结果：**
- ✅ 所有浏览器上界面显示正常
- ✅ 功能在所有浏览器上正常工作
- ✅ 无控制台错误或警告

---

## 性能测试

### 测试 1: 页面加载时间
**操作：**
1. 打开浏览器开发工具（F12）
2. 切换到"Network"标签
3. 访问 `http://localhost:3000/showrooms`
4. 观察加载时间

**预期结果：**
- ✅ 首次加载 < 3秒
- ✅ 重复访问 < 1秒（缓存）
- ✅ 所有资源加载成功（无404错误）

---

### 测试 2: 3D组件性能
**操作：**
1. 打开showrooms页面
2. 在3D展厅中旋转、缩放、移动视图
3. 切换楼层
4. 观察帧率和流畅度

**预期结果：**
- ✅ 3D交互流畅（60 FPS）
- ✅ 无明显延迟
- ✅ 楼层切换快速（< 500ms）

**检查项（开发工具Performance标签）：**
- [ ] FPS > 30
- [ ] 无长任务（> 50ms）
- [ ] CPU使用合理

---

## 错误处理测试

### 测试 1: 网络错误
**操作：**
1. 打开浏览器开发工具
2. 在"Network"标签中勾选"Offline"
3. 尝试提交预订表单
4. 取消离线模式

**预期结果：**
- ✅ 显示网络错误提示
- ✅ 表单数据不丢失
- ✅ 可以重试提交

---

### 测试 2: 3D加载失败
**操作：**
如果HDR文件加载失败（已有降级方案）：

**预期结果：**
- ✅ 显示"3D View Unavailable"提示
- ✅ 其他功能（选择区域、提交预订）仍可使用
- ✅ 页面不崩溃

---

## 快速参考：常见问题

| 问题 | 解决方案 |
|------|---------|
| 3D组件不显示 | 这是正常的 - 显示备用UI，其他功能不受影响 |
| 价格计算不对 | 检查：日期范围 × 日均价格 + 增值服务费用 |
| 表单无法提交 | 检查所有必填字段、邮箱格式、手机号位数 |
| 页面加载缓慢 | 检查网络连接、清除浏览器缓存 |
| 日期不能选择 | 确保结束日期 > 开始日期 |

---

## 测试清单总结

### 功能性测试
- [ ] 页面正确加载
- [ ] 3D展厅显示或显示降级UI
- [ ] 楼层选择工作正常
- [ ] 区域选择工作正常
- [ ] 日期选择工作正常
- [ ] 价格自动计算正确
- [ ] 增值服务价格计算正确
- [ ] 预订表单可以提交
- [ ] 预订确认页面显示正确

### 验证测试
- [ ] 空表单显示错误
- [ ] 无效邮箱显示错误
- [ ] 无效手机号显示错误
- [ ] 日期验证正确
- [ ] 参展人数验证正确

### 跨浏览器测试
- [ ] Chrome/Edge
- [ ] Firefox
- [ ] Safari

### 性能测试
- [ ] 页面加载 < 3s
- [ ] 3D交互流畅
- [ ] 无明显延迟

### 错误处理
- [ ] 网络错误处理
- [ ] 3D加载失败降级
- [ ] 无控制台错误

---

## 开发者调试技巧

### 查看控制台日志
```javascript
// 在浏览器控制台输入以查看预订数据
localStorage.getItem('booking_data')
```

### 模拟网络请求失败
```javascript
// 在Network标签中选择"Offline"或"Slow 3G"
```

### 检查组件状态
```javascript
// React DevTools 可以查看组件状态变化
```

### 清除本地数据
```javascript
// 在控制台清除localStorage
localStorage.clear()
// 刷新页面
```

---

## 完成标志

当以下所有条件都满足时，测试完成：

✅ **功能性**
- 所有主要流程可以完成
- 价格计算准确
- 表单提交成功

✅ **验证性**
- 所有验证错误显示正确
- 无法提交无效数据
- 错误消息清晰有用

✅ **兼容性**
- 在至少2个浏览器上测试
- 移动端和桌面端都可用
- 无控制台错误

✅ **性能**
- 页面加载时间可接受
- 3D交互流畅
- 无明显性能问题

✅ **健壮性**
- 错误情况处理得当
- 3D加载失败有降级方案
- 网络错误可恢复

---

祝你测试愉快！🎉
