# Demand-OS: Phase 3 UI/UX 优化方案

**版本**: 1.0  
**日期**: 2026-02-07  
**作者**: Manus AI

---

## 1. 概述

本方案旨在对 Demand-OS 项目在完成 Phase 3 (工作流可视化) 核心功能后的 UI/UX 进行全面优化。我们基于对现有代码库、设计文档 (`Demand-OSUI_UX设计指南.md`, `ACCIO_FRAMEWORK_DESIGN.md`) 和已完成功能 (`PHASE3_COMPLETION_REPORT.md`, `PHASE4_AGENT_PLATFORM_PROGRESS.md`) 的深入分析，提出以下优化建议。

核心目标是提升 **工作流编辑器 (Workflow Editor)** 的用户体验，使其从当前的可视化展示 (`workflow-visualizer.tsx`) 升级为功能完整、交互友好的在线编辑工具，并优化 Agent 市场的浏览和使用流程，使其更符合专业、高效的设计哲学。

## 2. 核心优化方向

我们将从以下三个关键方面进行 UI/UX 优化：

1.  **工作流编辑器 (Workflow Editor) 增强**：从“只读”升级为“可写”，实现完整的在线编辑功能。
2.  **Agent 市场体验优化**：提升模板的浏览、预览和使用效率。
3.  **统一视觉与交互**：确保所有新功能与现有 UI/UX 设计指南保持高度一致。

---

## 3. 工作流编辑器 (Workflow Editor) UI/UX 设计

这是本次优化的核心。我们将把现有的 `workflow-visualizer.tsx` 升级为一个功能完善的编辑器，对标 Accio 的核心体验。

### 3.1. 整体布局

采用经典的三栏式布局，为用户提供清晰、高效的编辑环境。

```
+--------------------------------------------------------------------+
| Header (全局导航)                                                  |
+----------------------+----------------------+----------------------+
|                      |                      |                      |
|                      |                      |                      |
|   **节点库**         |   **画布 (Canvas)**  |   **配置面板**       |
|   (Node Library)     |                      |   (Config Panel)     |
|                      |                      |                      |
|   - 输入节点         |   [拖拽节点于此]     |   - 节点设置         |
|   - AI 节点          |                      |   - 全局变量         |
|   - 数据源节点       |                      |   - 调试信息         |
|   - ...              |                      |                      |
|                      |                      |                      |
+----------------------+----------------------+----------------------+
| Footer (状态栏、保存、执行按钮)                                    |
+--------------------------------------------------------------------+
```

| 区域 | 功能描述 |
| :--- | :--- |
| **节点库 (左栏)** | - **分类展示**：按 `输入`、`AI`、`数据`、`逻辑`、`输出` 等分类组织节点。<br>- **拖拽添加**：用户可直接将节点从库中拖拽到画布上。<br>- **搜索功能**：快速查找所需节点。 |
| **画布 (中栏)** | - **核心编辑区**：使用 `React Flow`，支持节点的拖拽、连接、删除。<br>- **交互增强**：支持框选、对齐、缩放、小地图等辅助功能。<br>- **状态显示**：在节点上实时显示 `执行中`、`成功`、`失败` 等状态。 |
| **配置面板 (右栏)** | - **上下文感知**：根据当前选中的节点或画布，动态显示不同配置项。<br>- **标签页设计**：使用 `<Tabs>` 组件区分 `节点配置`、`全局变量`、`执行日志` 等。 |
| **页脚 (底部)** | - **核心操作**：放置 `保存`、`另存为`、`执行` 等高频操作按钮。<br>- **状态反馈**：显示当前工作流的保存状态和最后执行时间。 |

### 3.2. 节点设计与交互

遵循 `Demand-OSUI_UX设计指南.md` 的规范，为不同类型的节点设计独特且清晰的视觉样式。

| 节点类型 | 颜色 | 图标 (Lucide) | 交互说明 |
| :--- | :--- | :--- | :--- |
| **输入 (Input)** | `primary` | `LogIn` | 流程起点，通常不可删除。 |
| **AI (AI)** | `info` | `Sparkles` | 用于 AI 分析，配置面板可选择模型和 Prompt。 |
| **数据源 (Datasource)** | `success` | `Database` | 用于查询数据，可配置数据源和查询语句。 |
| **条件 (Condition)** | `warning` | `GitFork` | 用于逻辑分支，连接线上标记 `True`/`False`。 |
| **转换 (Transform)** | `muted-foreground` | `ArrowRightLeft` | 用于数据格式化或处理。 |
| **输出 (Output)** | `destructive` | `LogOut` | 流程终点，展示最终结果。 |

**交互细节**:
- **Hover 效果**: 鼠标悬停在节点上时，显示节点的完整名称和描述，并高亮相关连接线。
- **选中效果**: 节点被选中时，边框变为 `primary` 色，同时在右侧配置面板中显示其详细信息。
- **连接操作**: 从节点的 Handle (连接点) 拖拽出连接线，画布将高亮可连接的目标节点。

### 3.3. 配置面板 (Config Panel) 设计

配置面板是工作流编辑的核心交互区域，采用标签页设计，提高信息组织效率。

- **`<TabsTrigger value="node">节点配置</TabsTrigger>`**: 
  - 当选中一个节点时，此面板激活。
  - 动态生成表单，允许用户编辑节点的 `label`、`config` 等参数。
  - 例如，对于 AI 节点，提供一个文本域用于填写 Prompt。
- **`<TabsTrigger value="global">全局变量</TabsTrigger>`**: 
  - 允许用户定义和管理可在整个工作流中使用的变量，如 API Keys、全局参数等。
- **`<TabsTrigger value="log">执行日志</TabsTrigger>`**: 
  - 在执行工作流后，此处将实时显示每个节点的执行日志，便于调试。

---

## 4. Agent 市场和详情页 UI/UX 优化

基于 `PHASE4_AGENT_PLATFORM_PROGRESS.md` 中已完成的页面，进行以下优化。

### 4.1. Agent 市场 (`/agents`) 优化

- **引入“克隆”和“创建”操作**：
  - 将“使用模板”按钮的操作逻辑明确为“克隆模板”，并提供一个更醒目的“创建空白工作流”入口。
  - `<Button>克隆模板</Button>`
  - `<Button variant="outline">创建空白工作流</Button>`
- **增强预览功能**：
  - 当前的“预览”按钮可以优化为一个模态框 (Dialog)，在不离开市场页面的情况下，快速展示工作流的可视化图、节点详情和描述。
- **添加排序和布局切换**：
  - 增加按“使用次数”、“更新时间”排序的功能。
  - 提供“卡片视图”和“列表视图”两种布局切换，满足不同用户的浏览习惯。

### 4.2. Agent 详情页 (`/agents/[id]`) 优化

- **整合为统一的编辑器入口**：
  - 将此页面改造为工作流编辑器的主要入口。
  - 移除现有的 `代码视图` 和 `节点详情` 标签页，将其功能整合进新的三栏式编辑器布局中。
- **增加版本历史**：
  - 在配置面板中增加一个“版本历史”标签页，允许用户查看和恢复到之前的版本。

### 4.3. Agent 执行页 (`/agents/[id]/execute`) 优化

- **实时高亮执行节点**：
  - 在执行过程中，除了显示日志，还应在左侧的工作流可视化图中实时高亮当前正在执行的节点，提供更直观的进度反馈。
- **优化结果展示**：
  - 对执行结果进行结构化展示，而非简单的 JSON 输出。例如，如果结果是表格数据，则使用表格组件进行渲染。

---

## 5. 实施计划

建议将以上优化方案纳入 Phase 5 的开发计划中，并按以下步骤实施。

| 阶段 | 核心任务 | 涉及组件/页面 | 预计时间 |
| :--- | :--- | :--- | :--- |
| **1. 编辑器基础架构** | - 搭建三栏式布局。<br>- 引入可交互的 React Flow 画布。<br>- 实现节点的拖拽、连接和删除。 | `WorkflowEditorLayout.tsx`<br>`InteractiveCanvas.tsx` | 3-4 天 |
| **2. 节点库与配置面板** | - 开发节点库组件，支持分类和搜索。<br>- 开发动态配置面板，根据节点类型生成表单。 | `NodeLibrary.tsx`<br>`ConfigPanel.tsx` | 4-5 天 |
| **3. 市场与详情页优化** | - 改造 Agent 市场和详情页，集成新的编辑器。<br>- 实现预览模态框和版本历史功能。 | `/app/agents/...` | 2-3 天 |
| **4. 执行与调试优化** | - 在执行页面实现节点高亮。<br>- 优化结果展示。 | `/app/agents/[id]/execute/page.tsx` | 2-3 天 |
| **5. 整体测试与联调** | - 对整个工作流创建、编辑、执行流程进行端到端测试。 | - | 2 天 |

**总计**：约 13-17 天。

## 6. 结论

通过实施此 UI/UX 优化方案，Demand-OS 将拥有一个强大且用户友好的工作流编辑器，这将极大提升平台的核心竞争力，使其在对标 Accio 的道路上迈出关键一步。同时，优化的 Agent 市场和执行体验将进一步巩固其“专业、高效”的设计理念。
